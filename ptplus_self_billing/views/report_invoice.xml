<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <!-- Invoice document mods -->
    <template id="report_invoice_document" inherit_id="account.report_invoice_document">
        <!-- Company Address (x3)-->
        <xpath
            expr="//div[@name='address_not_same_as_shipping']/t[@t-set='address']"
            position="after"
        >
            <t t-set="address" t-if="o.l10n_pt_self_billing">
                <address
                    class="mb-0"
                    t-field="o.company_id.partner_id"
                    t-options='{"widget": "contact", "fields": ["address", "name"], "no_marker": True}'
                />
            </t>
        </xpath>
        <xpath
            expr="//div[@name='address_same_as_shipping']/t[@t-set='address']"
            position="after"
        >
            <t t-set="address" t-if="o.l10n_pt_self_billing">
                <address
                    class="mb-0"
                    t-field="o.company_id.partner_id"
                    t-options='{"widget": "contact", "fields": ["address", "name"], "no_marker": True}'
                />
            </t>
        </xpath>
        <xpath expr="//div[@name='no_shipping']/t[@t-set='address']" position="after">
            <t t-set="address" t-if="o.l10n_pt_self_billing">
                <address
                    class="mb-0"
                    t-field="o.company_id.partner_id"
                    t-options='{"widget": "contact", "fields": ["address", "name"], "no_marker": True}'
                />
            </t>
        </xpath>

        <!-- Company Vat No. -->
        <xpath
            expr="//div[@t-if='o.source_billing and o.partner_id.vat']"
            position="after"
        >
            <div
                t-attf-class="#{'col-auto col-3 mw-100' if report_type != 'html' else 'col'} mb-2"
                t-if="o.company_id.partner_id.vat and o.l10n_pt_self_billing"
            >
                <strong><t
                    t-out="o.company_id.country_id.vat_label or 'Tax ID'"
                />:</strong>
                <br />
                <span t-out="o.company_id.partner_id.pt_get_vat()" />
            </div>
        </xpath>
        <xpath
            expr="//div[@t-if='o.source_billing and o.partner_id.vat']"
            position="attributes"
        >
            <attribute
                name="t-if"
            >o.partner_id.vat and not o.l10n_pt_self_billing</attribute>
        </xpath>
    </template>
</odoo>
