<?xml version="1.0" encoding="UTF-8" ?>
<templates id="template" xml:space="preserve">

    <t t-inherit="point_of_sale.ReceiptHeader" t-inherit-mode="extension">
        <xpath expr="//div[hasclass('pos-receipt-contact')]//div" position="before">
            <t t-if="props.data.l10n_pt_invoicing">
                <div
                    t-if="props.data.company.l10n_pt_unique_id"
                    t-esc="props.data.l10n_pt_unique_id"
                />
                <div
                    t-if="props.data.company.street"
                    t-esc="props.data.company.street"
                />
                <div t-if="props.data.company.zip" t-esc="props.data.company.zip" />
                <div t-if="props.data.company.city" t-esc="props.data.company.city" />
                <div t-if="props.data.company.state_id">(<t
                        t-esc="props.data.company.state_id[1]"
                    />)</div>
            </t>
        </xpath>

        <xpath expr="//div[@t-if='props.data.cashier']" position="before">
            <t t-set="partner" t-value="props.data.partner" />
            <t t-if="props.data.l10n_pt_invoicing and partner">
                <div>--------------------------------</div>
                <div id="l10n_pt_doc_name"><t
                        t-esc="props.data.l10n_pt_doc_name"
                    /></div>
                <div>Customer: <t t-esc="partner.name" /></div>
                <div t-if="partner.vat"><t
                        t-esc="props.data.company.country?.vat_label || 'Tax ID'"
                    />: <t t-esc="partner.vat" /></div>
            </t>
        </xpath>
    </t>

    <t t-inherit="point_of_sale.OrderReceipt" t-inherit-mode="extension">
        <xpath expr="//div[hasclass('before-footer')]" position="inside">
            <div id="pt_qrbox" t-if="props.data.l10n_pt_qr_code">
                <div id="atcud">
                    <span>ATCUD:</span>
                    <span t-esc="props.data.l10n_pt_atcud" />
                </div>
                <img
                    id="pt_qrcode"
                    t-att-src="props.data.l10n_pt_qr_code"
                    class="pt_qrcode"
                />
            </div>
            <div class="pos-receipt-contact"><t
                    t-esc="props.data.l10n_pt_certification_text"
                /></div>
        </xpath>

        <xpath expr="//t[@t-as='tax']//span[2]" position="inside">
            <t
                t-if="tax.tax.pt_vat_exemption_reason"
                t-esc="tax.tax.pt_vat_exemption_reason"
            />
        </xpath>

        <xpath expr="//div[hasclass('before-footer')]" position="before">
            <t t-foreach="props.data.tax_details" t-as="tax" t-key="tax.name">
                <div>
                    <span
                        class="pt_vat_exemption_reason_description"
                        t-esc="tax.tax.l10n_pt_vat_exemption_reason_text or ''"
                    />
                </div>
            </t>
        </xpath>

        <xpath expr="//div[hasclass('pos-receipt-taxes')]" position="attributes">
            <attribute name="class">pos-receipt-taxes text-nowrap</attribute>
        </xpath>
    </t>

</templates>
